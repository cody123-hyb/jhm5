<!DOCTYPE html>
<html lang="zh-HK">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>香港DSE成績分析器</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            box-sizing: border-box;
            font-family: "Microsoft JhengHei", "微軟正黑體", "PingFang TC", "Helvetica Neue", sans-serif;
        }
        body {
            max-width: 900px;
            margin: 0 auto;
            padding: 20px;
            background: linear-gradient(135deg, #f5f7fa 0%, #e4edf5 100%);
            color: #333;
            line-height: 1.6;
        }
        header {
            text-align: center;
            margin-bottom: 30px;
            padding: 25px 20px;
            background: linear-gradient(135deg, #1a237e 0%, #283593 100%);
            color: white;
            border-radius: 12px;
            box-shadow: 0 6px 15px rgba(0, 0, 0, 0.1);
        }
        h1 {
            margin: 0 0 10px;
            font-size: 2.2em;
            font-weight: 700;
        }
        .subtitle {
            font-size: 1.1em;
            opacity: 0.9;
            margin: 0;
        }
        h2 {
            color: #283593;
            padding-bottom: 10px;
            border-bottom: 2px solid #e0e0e0;
            margin-top: 0;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        h2 i {
            color: #3949ab;
        }
        h3 {
            color: #3949ab;
            margin-top: 0;
        }
        .section {
            background-color: white;
            padding: 25px;
            margin-bottom: 25px;
            border-radius: 12px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.08);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }
        .section:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 15px rgba(0,0,0,0.12);
        }
        .subject-container {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(220px, 1fr));
            gap: 15px;
            margin-bottom: 15px;
        }
        .subject-item {
            display: flex;
            flex-direction: column;
            gap: 8px;
            padding: 15px;
            background-color: #f8f9ff;
            border-radius: 10px;
            border-left: 4px solid #3949ab;
            transition: all 0.3s ease;
        }
        .subject-item:hover {
            background-color: #e8eaf6;
            transform: translateX(5px);
        }
        .subject-item label {
            font-weight: 600;
            color: #1a237e;
        }
        select {
            padding: 10px;
            border-radius: 6px;
            border: 1px solid #c5cae9;
            background-color: white;
            font-size: 1em;
            transition: border 0.3s;
        }
        select:focus {
            border-color: #3949ab;
            outline: none;
            box-shadow: 0 0 0 2px rgba(57, 73, 171, 0.2);
        }
        button {
            background: linear-gradient(135deg, #3949ab 0%, #283593 100%);
            color: white;
            border: none;
            padding: 12px 20px;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.3s;
            font-weight: 600;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            box-shadow: 0 3px 8px rgba(57, 73, 171, 0.3);
        }
        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 12px rgba(57, 73, 171, 0.4);
        }
        .remove-btn {
            background: linear-gradient(135deg, #f44336 0%, #d32f2f 100%);
            padding: 6px 12px;
            font-size: 0.85em;
            margin-top: 5px;
        }
        .remove-btn:hover {
            box-shadow: 0 5px 12px rgba(244, 67, 54, 0.4);
        }
        .result-section {
            display: none;
            background: linear-gradient(135deg, #e8eaf6 0%, #f8f9ff 100%);
            padding: 25px;
            border-radius: 12px;
            margin-top: 20px;
            border: 1px solid #c5cae9;
        }
        .result-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 25px;
        }
        .result-card {
            background: white;
            padding: 20px;
            border-radius: 10px;
            text-align: center;
            box-shadow: 0 3px 10px rgba(0,0,0,0.08);
        }
        .result-value {
            font-weight: bold;
            font-size: 1.8em;
            color: #1a237e;
            margin: 10px 0;
        }
        .chance-high {
            color: #4caf50;
        }
        .chance-medium {
            color: #ff9800;
        }
        .chance-low {
            color: #f44336;
        }
        .suggestion-item {
            margin-bottom: 12px;
            padding-left: 25px;
            position: relative;
        }
        .suggestion-item:before {
            content: "•";
            position: absolute;
            left: 10px;
            color: #3949ab;
            font-size: 1.5em;
        }
        .add-subject {
            display: flex;
            gap: 10px;
            margin-top: 20px;
            align-items: center;
        }
        #subjectSelector {
            flex-grow: 1;
            padding: 12px;
            border-radius: 6px;
            border: 1px solid #c5cae9;
            font-size: 1em;
            transition: border 0.3s;
        }
        #subjectSelector:focus {
            border-color: #3949ab;
            outline: none;
            box-shadow: 0 0 0 2px rgba(57, 73, 171, 0.2);
        }
        .note {
            font-size: 0.9em;
            color: #666;
            margin-top: 10px;
            font-style: italic;
        }
        .analyze-btn {
            width: 100%;
            padding: 15px;
            font-size: 1.2em;
            margin-top: 10px;
        }
        .elective-count {
            display: inline-block;
            background: #3949ab;
            color: white;
            border-radius: 50%;
            width: 24px;
            height: 24px;
            text-align: center;
            line-height: 24px;
            font-size: 0.8em;
            margin-left: 5px;
        }
        footer {
            text-align: center;
            margin-top: 30px;
            color: #666;
            font-size: 0.9em;
            padding: 15px;
        }
        .ranking-details {
            margin-top: 15px;
            padding: 15px;
            background-color: #f0f2ff;
            border-radius: 8px;
            border-left: 4px solid #3949ab;
        }
        .ranking-details h4 {
            margin-top: 0;
            color: #283593;
        }
        .ranking-bar {
            height: 20px;
            background: linear-gradient(to right, #f44336, #ff9800, #4caf50);
            border-radius: 10px;
            margin: 10px 0;
            position: relative;
        }
        .ranking-marker {
            position: absolute;
            top: -5px;
            width: 10px;
            height: 30px;
            background-color: #1a237e;
            border-radius: 5px;
            transform: translateX(-50%);
        }
        .ranking-labels {
            display: flex;
            justify-content: space-between;
            font-size: 0.85em;
            color: #666;
        }
        .chance-criteria {
            margin-top: 15px;
            padding: 15px;
            background-color: #f0f2ff;
            border-radius: 8px;
            border-left: 4px solid #3949ab;
        }
        .chance-criteria h4 {
            margin-top: 0;
            color: #283593;
        }
        .chance-criteria ul {
            margin: 0;
            padding-left: 20px;
        }
        .chance-criteria li {
            margin-bottom: 5px;
        }
        .english-warning {
            background-color: #ffebee;
            border-left: 4px solid #f44336;
            padding: 10px 15px;
            margin-top: 10px;
            border-radius: 4px;
            color: #c62828;
        }
        @media (max-width: 600px) {
            .subject-container {
                grid-template-columns: 1fr;
            }
            .result-grid {
                grid-template-columns: 1fr;
            }
            .add-subject {
                flex-direction: column;
            }
            button {
                width: 100%;
            }
        }
    </style>
</head>
<body>
    <header>
        <h1><i class="fas fa-chart-line"></i> 香港DSE成績分析器</h1>
        <p class="subtitle">輸入您的DSE成績，獲取詳細分析及升學建議</p>
    </header>

    <div class="section">
        <h2><i class="fas fa-book"></i> 核心科目成績</h2>
        <div class="subject-container" id="coreSubjects">
            <!-- 核心科目會由JavaScript動態生成 -->
        </div>
    </div>

    <div class="section">
        <h2><i class="fas fa-list-alt"></i> 選修科目成績 <span class="elective-count" id="electiveCount">0</span></h2>
        <div class="subject-container" id="electiveSubjects">
            <!-- 選修科目會由JavaScript動態生成 -->
        </div>
        
        <div class="add-subject">
            <select id="subjectSelector">
                <option value="">請選擇選修科目</option>
                <!-- 選修科目選項會由JavaScript動態生成 -->
            </select>
            <button id="addSubjectBtn"><i class="fas fa-plus"></i> 添加選修科目</button>
        </div>
        <p class="note">提示：您可以從下拉選單選擇選修科目並添加，最多可添加8個選修科目</p>
    </div>

    <div class="section">
        <button id="analyzeBtn" class="analyze-btn"><i class="fas fa-chart-bar"></i> 分析成績</button>
    </div>

    <div class="section result-section" id="resultSection">
        <h2><i class="fas fa-poll"></i> 成績分析結果</h2>
        
        <div class="result-grid">
            <div class="result-card">
                <h3>總分</h3>
                <p class="result-value" id="totalScore">--</p>
                <p>基於您輸入的科目成績計算</p>
            </div>
            
            <div class="result-card">
                <h3>全港排名預估</h3>
                <p class="result-value" id="ranking">--</p>
                <p>與全港考生比較</p>
            </div>
            
            <div class="result-card">
                <h3>入學機會</h3>
                <p class="result-value" id="admissionChance">--</p>
                <p>大學入學機會評估</p>
            </div>
        </div>
        
        <div id="englishWarning" class="english-warning" style="display: none;">
            <i class="fas fa-exclamation-triangle"></i> <strong>注意：</strong> 由於您的英文成績低於3級，入學機會評估為低。許多大學課程要求英文達到3級或以上。
        </div>
        
        <div class="ranking-details">
            <h4><i class="fas fa-chart-bar"></i> 全港排名分析</h4>
            <div class="ranking-bar">
                <div class="ranking-marker" id="rankingMarker"></div>
            </div>
            <div class="ranking-labels">
                <span>後30%</span>
                <span>前70%</span>
                <span>前50%</span>
                <span>前20%</span>
                <span>前5%</span>
                <span>前1%</span>
            </div>
            <p id="rankingDetails">--</p>
        </div>
        
        <div class="chance-criteria">
            <h4><i class="fas fa-info-circle"></i> 入學機會評級標準</h4>
            <ul>
                <li><strong>低</strong>：英文成績3級以下 或 總分12分以下</li>
                <li><strong>中</strong>：英文成績3級或以上，且總分12分或以上，20分或以下</li>
                <li><strong>高</strong>：英文成績3級或以上，且總分21分或以上</li>
            </ul>
        </div>
        
        <div class="result-item">
            <h3><i class="fas fa-lightbulb"></i> 個人化建議</h3>
            <div id="suggestions">
                <!-- 建議會由JavaScript動態生成 -->
            </div>
        </div>
    </div>

    <footer>
        <p>© 2023 香港DSE成績分析器 | 僅供參考，實際入學情況請以各大學官方信息為準</p>
    </footer>

    <script>
        // 科目數據
        const coreSubjects = [
            { name: "中文", id: "chinese" },
            { name: "英文", id: "english" },
            { name: "數學", id: "math" },
            { name: "公民與社會發展", id: "ls", isPassFail: true }
        ];
        
        const electiveSubjectOptions = [
            "中國文學", "生物", "企業、會計與財務概論", "英語文學", "化學", 
            "設計與應用科技", "中國歷史", "物理", "健康管理與社會關懷", 
            "經濟", "資訊及通訊科技", "倫理與宗教", "科技與生活", "地理", 
            "音樂", "歷史", "視覺藝術", "旅遊與款待", "體育", 
            "數學延伸部分（M1）", "數學延伸部分（M2）"
        ];
        
        const grades = ["U", "1", "2", "3", "4", "5", "5*", "5**"];
        
        // 初始化頁面
        document.addEventListener('DOMContentLoaded', function() {
            // 生成核心科目
            const coreContainer = document.getElementById('coreSubjects');
            coreSubjects.forEach(subject => {
                const subjectDiv = document.createElement('div');
                subjectDiv.className = 'subject-item';
                
                const label = document.createElement('label');
                label.textContent = subject.name;
                label.htmlFor = subject.id;
                
                const select = document.createElement('select');
                select.id = subject.id;
                
                if (subject.isPassFail) {
                    // 公民與社會發展只有達標/不達標
                    select.innerHTML = `
                        <option value="">請選擇</option>
                        <option value="pass">達標</option>
                        <option value="fail">不達標</option>
                    `;
                } else {
                    // 其他科目有8個等級
                    select.innerHTML = `<option value="">請選擇</option>` + 
                        grades.map(grade => `<option value="${grade}">${grade}</option>`).join('');
                }
                
                subjectDiv.appendChild(label);
                subjectDiv.appendChild(select);
                coreContainer.appendChild(subjectDiv);
            });
            
            // 生成選修科目選擇器
            const subjectSelector = document.getElementById('subjectSelector');
            electiveSubjectOptions.forEach(subject => {
                const option = document.createElement('option');
                option.value = subject;
                option.textContent = subject;
                subjectSelector.appendChild(option);
            });
            
            // 更新選修科目計數
            updateElectiveCount();
            
            // 添加選修科目按鈕事件
            document.getElementById('addSubjectBtn').addEventListener('click', function() {
                const selectedSubject = document.getElementById('subjectSelector').value;
                if (selectedSubject) {
                    if (document.querySelectorAll('#electiveSubjects .subject-item').length >= 8) {
                        alert('已達到選修科目上限（8科）');
                        return;
                    }
                    
                    // 檢查是否已添加該科目
                    const existingSubjects = Array.from(document.querySelectorAll('#electiveSubjects .subject-item label'))
                        .map(label => label.textContent);
                    
                    if (existingSubjects.includes(selectedSubject)) {
                        alert('您已經添加了此科目');
                        return;
                    }
                    
                    addElectiveSubject(selectedSubject);
                    document.getElementById('subjectSelector').value = '';
                    updateElectiveCount();
                } else {
                    alert('請選擇一個科目');
                }
            });
            
            // 分析按鈕事件
            document.getElementById('analyzeBtn').addEventListener('click', analyzeResults);
        });
        
        // 添加選修科目函數
        function addElectiveSubject(name) {
            const container = document.getElementById('electiveSubjects');
            
            const subjectDiv = document.createElement('div');
            subjectDiv.className = 'subject-item';
            
            const label = document.createElement('label');
            label.textContent = name;
            
            const select = document.createElement('select');
            select.innerHTML = `<option value="">請選擇</option>` + 
                grades.map(grade => `<option value="${grade}">${grade}</option>`).join('');
            
            const removeBtn = document.createElement('button');
            removeBtn.innerHTML = '<i class="fas fa-times"></i> 移除';
            removeBtn.className = 'remove-btn';
            removeBtn.addEventListener('click', function() {
                container.removeChild(subjectDiv);
                updateElectiveCount();
            });
            
            subjectDiv.appendChild(label);
            subjectDiv.appendChild(select);
            subjectDiv.appendChild(removeBtn);
            container.appendChild(subjectDiv);
        }
        
        // 更新選修科目計數
        function updateElectiveCount() {
            const count = document.querySelectorAll('#electiveSubjects .subject-item').length;
            document.getElementById('electiveCount').textContent = count;
        }
        
        // 分析成績函數
        function analyzeResults() {
            // 收集核心科目成績
            let totalScore = 0;
            let coreCount = 0;
            let englishGrade = null;
            
            coreSubjects.forEach(subject => {
                const select = document.getElementById(subject.id);
                const value = select.value;
                
                if (value) {
                    if (subject.isPassFail) {
                        // 公民與社會發展：達標=4分，不達標=0分
                        totalScore += value === 'pass' ? 4 : 0;
                    } else {
                        // 其他科目：U=0, 1=1, 2=2, ..., 5**=7
                        const gradeIndex = grades.indexOf(value);
                        totalScore += gradeIndex;
                        
                        // 特別記錄英文成績
                        if (subject.id === 'english') {
                            englishGrade = value;
                        }
                    }
                    coreCount++;
                }
            });
            
            // 收集選修科目成績
            const electiveItems = document.querySelectorAll('#electiveSubjects .subject-item');
            let electiveCount = 0;
            
            electiveItems.forEach(item => {
                const select = item.querySelector('select');
                const value = select.value;
                
                if (value) {
                    const gradeIndex = grades.indexOf(value);
                    totalScore += gradeIndex;
                    electiveCount++;
                }
            });
            
            // 計算總分
            const totalSubjects = coreCount + electiveCount;
            
            if (totalSubjects === 0) {
                alert('請至少輸入一科成績');
                return;
            }
            
            // 顯示結果
            document.getElementById('totalScore').textContent = totalScore + ' 分';
            
            // 估算排名（基於總分）
            const ranking = estimateRanking(totalScore, totalSubjects);
            document.getElementById('ranking').textContent = ranking.percentile;
            
            // 更新排名視覺化
            updateRankingVisualization(ranking.position);
            
            // 顯示排名詳細信息
            document.getElementById('rankingDetails').textContent = ranking.details;
            
            // 估算入學機會（按照新標準，英文3級以下直接為低）
            const chance = estimateAdmissionChance(totalScore, englishGrade);
            const chanceElement = document.getElementById('admissionChance');
            chanceElement.textContent = chance.text;
            chanceElement.className = 'result-value ' + chance.class;
            
            // 顯示或隱藏英文警告
            const englishWarning = document.getElementById('englishWarning');
            if (chance.englishLow) {
                englishWarning.style.display = 'block';
            } else {
                englishWarning.style.display = 'none';
            }
            
            // 生成建議
            generateSuggestions(totalScore, totalSubjects, coreCount, electiveCount, ranking.percentile, chance.text, englishGrade);
            
            // 顯示結果區域
            document.getElementById('resultSection').style.display = 'block';
            
            // 滾動到結果區域
            document.getElementById('resultSection').scrollIntoView({ behavior: 'smooth' });
        }
        
        // 估算排名
        function estimateRanking(score, subjectCount) {
            // 簡化的排名估算模型（實際應用中應使用更複雜的算法）
            const avgScore = score / subjectCount;
            let percentile, position, details;
            
            if (avgScore >= 6.5) {
                percentile = '前 1%';
                position = 95;
                details = '您的成績非常優秀，屬於全港頂尖水平，預計排名在全港前1%的考生中。';
            } else if (avgScore >= 6) {
                percentile = '前 5%';
                position = 85;
                details = '您的成績優秀，預計排名在全港前5%的考生中，屬於高水平的考生。';
            } else if (avgScore >= 5) {
                percentile = '前 20%';
                position = 70;
                details = '您的成績良好，預計排名在全港前20%的考生中，表現優於大多數考生。';
            } else if (avgScore >= 4) {
                percentile = '前 50%';
                position = 50;
                details = '您的成績中等，預計排名在全港前50%的考生中，處於中等水平。';
            } else if (avgScore >= 3) {
                percentile = '前 70%';
                position = 30;
                details = '您的成績略低於平均水平，預計排名在全港前70%的考生中。';
            } else {
                percentile = '後 30%';
                position = 15;
                details = '您的成績有待提升，預計排名在全港後30%的考生中，建議考慮重考或加強學習。';
            }
            
            return { percentile, position, details };
        }
        
        // 更新排名視覺化
        function updateRankingVisualization(position) {
            const marker = document.getElementById('rankingMarker');
            marker.style.left = position + '%';
        }
        
        // 估算入學機會（按照新標準：英文3級以下直接為低）
        function estimateAdmissionChance(totalScore, englishGrade) {
            // 檢查英文成績是否低於3級
            if (englishGrade && grades.indexOf(englishGrade) < 3) {
                return { text: '低', class: 'chance-low', englishLow: true };
            }
            
            // 如果英文成績符合要求，按總分評級
            if (totalScore < 12) {
                return { text: '低', class: 'chance-low', englishLow: false };
            } else if (totalScore >= 12 && totalScore <= 20) {
                return { text: '中', class: 'chance-medium', englishLow: false };
            } else {
                return { text: '高', class: 'chance-high', englishLow: false };
            }
        }
        
        // 生成建議
        function generateSuggestions(totalScore, subjectCount, coreCount, electiveCount, ranking, chance, englishGrade) {
            const suggestionsContainer = document.getElementById('suggestions');
            suggestionsContainer.innerHTML = '';
            
            const avgScore = subjectCount > 0 ? totalScore / subjectCount : 0;
            
            // 檢查英文成績是否低於3級
            const isEnglishLow = englishGrade && grades.indexOf(englishGrade) < 3;
            
            // 根據入學機會生成建議
            if (chance === '高') {
                addSuggestion(suggestionsContainer, "您的入學機會高，可以考慮申請香港大學、中文大學、科技大學等頂尖大學的熱門學科。");
                addSuggestion(suggestionsContainer, "考慮申請獎學金計劃，許多大學為成績優異的學生提供豐厚獎學金。");
                addSuggestion(suggestionsContainer, "可以嘗試申請海外知名大學，您的成績有很強的競爭力。");
            } else if (chance === '中') {
                addSuggestion(suggestionsContainer, "您的入學機會中等，可以考慮申請八大院校的大多數學科。");
                addSuggestion(suggestionsContainer, "準備一份出色的個人陳述，突出您的優勢和課外活動經歷。");
                addSuggestion(suggestionsContainer, "考慮申請聯招以外的自資學位課程，增加入學機會。");
            } else {
                addSuggestion(suggestionsContainer, "您的入學機會較低，建議選擇要求相對較低的學科作為首選。");
                addSuggestion(suggestionsContainer, "考慮申請副學士或高級文憑課程，完成後可銜接大學學位。");
                addSuggestion(suggestionsContainer, "參加面試準備課程，提高在面試中的表現。");
            }
            
            // 如果英文成績低於3級，添加特別建議
            if (isEnglishLow) {
                addSuggestion(suggestionsContainer, "您的英文成績低於3級，建議優先考慮重考英文科目，因為大多數大學課程要求英文達到3級或以上。");
                addSuggestion(suggestionsContainer, "可以考慮報讀英文補習課程或參加英文能力提升計劃。");
                addSuggestion(suggestionsContainer, "尋找不要求英文3級的大學課程或考慮海外升學選項。");
            }
            
            // 根據排名添加建議
            if (ranking.includes('前 1%') || ranking.includes('前 5%')) {
                addSuggestion(suggestionsContainer, "基於您的優秀排名，建議優先考慮競爭激烈的熱門學科。");
            } else if (ranking.includes('前 20%')) {
                addSuggestion(suggestionsContainer, "您的排名較高，可以嘗試申請競爭較為激烈的學科。");
            } else if (ranking.includes('前 50%')) {
                addSuggestion(suggestionsContainer, "您的排名處於中等水平，建議選擇與您成績匹配的學科。");
            } else {
                addSuggestion(suggestionsContainer, "您的排名有待提升，建議考慮多種升學途徑和備選方案。");
            }
            
            // 通用建議
            addSuggestion(suggestionsContainer, "詳細研究各院校的收生要求，制定合理的選科策略。");
            addSuggestion(suggestionsContainer, "參加院校資訊日，直接與教授和在校學生交流。");
            addSuggestion(suggestionsContainer, "準備備選方案，包括自資學位、副學士和海外升學選項。");
        }
        
        // 添加建議到容器
        function addSuggestion(container, text) {
            const suggestion = document.createElement('div');
            suggestion.className = 'suggestion-item';
            suggestion.textContent = text;
            container.appendChild(suggestion);
        }
    </script>
</body>
</html>